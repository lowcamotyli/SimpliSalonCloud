{"version":"1.153.0","results":[{"check_id":"javascript.node-crypto.security.gcm-no-tag-length.gcm-no-tag-length","path":"lib\\messaging\\crypto.ts","start":{"line":91,"col":20,"offset":2765},"end":{"line":91,"col":60,"offset":2805},"extra":{"message":"The call to 'createDecipheriv' with the Galois Counter Mode (GCM) mode of operation is missing an expected authentication tag length. If the expected authentication tag length is not specified or otherwise checked, the application might be tricked into verifying a shorter-than-expected authentication tag. This can be abused by an attacker to spoof ciphertexts or recover the implicit authentication key of GCM, allowing arbitrary forgeries.","metadata":{"cwe":["CWE-310: CWE CATEGORY: Cryptographic Issues"],"owasp":["A02:2021 - Cryptographic Failures","A04:2025 - Cryptographic Failures"],"category":"security","subcategory":["vuln"],"technology":["node-crypto"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","references":["https://www.securesystems.de/blog/forging_ciphertexts_under_Galois_Counter_Mode_for_the_Node_js_crypto_module/","https://nodejs.org/api/crypto.html#cryptocreatedecipherivalgorithm-key-iv-options","https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/javascript.node-crypto.security.gcm-no-tag-length.gcm-no-tag-length","shortlink":"https://sg.run/NbGG1"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["app\\api\\crm\\campaigns\\route.ts","app\\api\\crm\\campaigns\\worker\\route.ts","app\\api\\crm\\quick-send\\route.ts","app\\api\\crm\\segments\\preview\\route.ts","app\\api\\crm\\templates\\route.ts","app\\api\\crm\\test-email\\route.ts","app\\api\\settings\\route.ts","app\\api\\webhooks\\resend\\route.ts","lib\\messaging\\crypto.ts","lib\\messaging\\email-sender.ts","lib\\messaging\\template-renderer.ts","lib\\middleware\\feature-gate.ts","lib\\payments\\subscription-manager.ts"]},"time":{"rules":[],"rules_parse_time":0.5826637744903565,"profiling_times":{"config_time":3.6409912109375,"core_time":19.03259515762329,"ignores_time":0.0009794235229492188,"total_time":24.050442218780518},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.0346715450286865,"per_file_time":{"mean":0.026530039616120164,"std_dev":0.001933040250996167},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":1.0,"rules_selected_ratio":0.04048582995951417,"rules_matched_ratio":0.04048582995951417},"targets":[],"total_bytes":0,"max_memory_bytes":910181952},"engine_requested":"OSS","skipped_rules":[],"profiling_results":[]}